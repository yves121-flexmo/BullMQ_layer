<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URGENT - Paiement en retard</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { background: #e74c3c; color: white; padding: 20px; text-align: center; border-radius: 8px 8px 0 0; }
        .content { background: #ffeaea; padding: 30px; border: 2px solid #e74c3c; border-radius: 0 0 8px 8px; }
        .urgent-alert { background: #e74c3c; color: white; padding: 20px; border-radius: 4px; margin: 20px 0; text-align: center; }
        .reimbursement-details { background: white; padding: 20px; border-radius: 4px; margin: 20px 0; border-left: 4px solid #e74c3c; }
        .button { display: inline-block; background: #e74c3c; color: white; padding: 15px 30px; text-decoration: none; border-radius: 4px; margin: 20px 0; font-weight: bold; }
        .button-secondary { background: #34495e; }
        .footer { text-align: center; margin-top: 20px; font-size: 12px; color: #666; }
        .penalty-info { background: #fff5f5; border: 1px solid #e74c3c; padding: 15px; border-radius: 4px; margin: 20px 0; }
        .overdue-days { font-size: 1.5em; color: #e74c3c; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš¨ PAIEMENT EN RETARD</h1>
            <p style="font-size: 1.2em; margin: 0;">Action immÃ©diate requise</p>
        </div>
        
        <div class="content">
            <% if (recipient && recipient.name) { %>
            <p>Bonjour <strong><%= recipient.name %></strong>,</p>
            <% } else { %>
            <p>Bonjour,</p>
            <% } %>
            
            <div class="urgent-alert">
                <h2 style="margin: 0;">âš ï¸ ATTENTION - PAIEMENT EN RETARD</h2>
                <% if (daysInfo && daysInfo.overdueDays) { %>
                <p style="margin: 10px 0 0 0;">
                    Votre paiement est en retard de 
                    <span class="overdue-days"><%= daysInfo.overdueDays %> jour<%= daysInfo.overdueDays > 1 ? 's' : '' %></span>
                </p>
                <% } %>
            </div>
            
            <p><strong>Ce message nÃ©cessite votre attention immÃ©diate.</strong> Un remboursement prÃ©vu est maintenant en retard et doit Ãªtre traitÃ© d'urgence.</p>
            
            <% if (reimbursement) { %>
            <div class="reimbursement-details">
                <h3>ğŸ“„ DÃ©tails du remboursement en retard</h3>
                
                <% if (reimbursement.id) { %>
                <p><strong>RÃ©fÃ©rence :</strong> <span style="color: #e74c3c; font-weight: bold;"><%= reimbursement.id %></span></p>
                <% } %>
                
                <% if (reimbursement.type) { %>
                <p><strong>Type :</strong> <%= reimbursement.type === 'SALARY' ? 'Salaire' : reimbursement.type === 'TREASURY' ? 'TrÃ©sorerie' : reimbursement.type %></p>
                <% } %>
                
                <% if (reimbursement.amount) { %>
                <p><strong>Montant dÃ» :</strong> <span style="font-size: 1.4em; color: #e74c3c; font-weight: bold;"><%= reimbursement.amount.toLocaleString('fr-FR') %>â‚¬</span></p>
                <% } %>
                
                <% if (reimbursement.dueDate) { %>
                <p><strong>Date d'Ã©chÃ©ance dÃ©passÃ©e :</strong> <span style="color: #e74c3c; font-weight: bold;"><%= new Date(reimbursement.dueDate).toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) %></span></p>
                <% } %>
                
                <% if (daysInfo && daysInfo.overdueDays) { %>
                <p><strong>Retard :</strong> <span style="color: #e74c3c; font-weight: bold;"><%= daysInfo.overdueDays %> jour<%= daysInfo.overdueDays > 1 ? 's' : '' %></span></p>
                <% } %>
                
                <% if (reimbursement.description) { %>
                <p><strong>Description :</strong> <%= reimbursement.description %></p>
                <% } %>
                
                <% if (reimbursement.beneficiary) { %>
                <p><strong>BÃ©nÃ©ficiaire :</strong> <%= reimbursement.beneficiary %></p>
                <% } %>
                
                <p><strong>Statut :</strong> <span style="color: #e74c3c; font-weight: bold;">ğŸ”´ EN RETARD</span></p>
            </div>
            <% } %>
            
            <% if (daysInfo && daysInfo.overdueDays >= 7) { %>
            <div class="penalty-info">
                <h3>âš ï¸ PÃ©nalitÃ©s de retard</h3>
                <p><strong>Attention :</strong> Ce retard de plus de 7 jours peut entraÃ®ner :</p>
                <ul>
                    <li>ğŸ”º Application de pÃ©nalitÃ©s financiÃ¨res</li>
                    <li>ğŸ“‹ Signalement aux instances compÃ©tentes</li>
                    <li>âš–ï¸ ProcÃ©dures de recouvrement</li>
                    <li>ğŸ“Š Impact sur votre Ã©valuation</li>
                </ul>
            </div>
            <% } %>
            
            <h3>ğŸš¨ Actions URGENTES requises</h3>
            <ul>
                <li><strong>ğŸ“ Contactez immÃ©diatement votre responsable financier</strong></li>
                <li><strong>ğŸ’° Effectuez le paiement dans les plus brefs dÃ©lais</strong></li>
                <li><strong>ğŸ“§ Confirmez la rÃ©gularisation par email</strong></li>
                <li><strong>ğŸ“‹ Fournissez une justification du retard</strong></li>
                <% if (daysInfo && daysInfo.overdueDays >= 3) { %>
                <li><strong>ğŸ¢ Informez votre hiÃ©rarchie directe</strong></li>
                <% } %>
            </ul>
            
            <% if (reimbursement && reimbursement.paymentUrl) { %>
            <p style="text-align: center;">
                <a href="<%= reimbursement.paymentUrl %>" class="button">ğŸš¨ PAYER IMMÃ‰DIATEMENT</a>
            </p>
            <% } %>
            
            <% if (reimbursement && reimbursement.contactUrl) { %>
            <p style="text-align: center;">
                <a href="<%= reimbursement.contactUrl %>" class="button button-secondary">ğŸ“ CONTACTER LE SUPPORT</a>
            </p>
            <% } %>
            
            <div class="urgent-alert">
                <p><strong>â° DÃ‰LAI CRITIQUE :</strong> Ce paiement doit Ãªtre rÃ©gularisÃ© dans les 24 heures pour Ã©viter des mesures supplÃ©mentaires.</p>
            </div>
            
            <h3>ğŸ“‹ Informations importantes</h3>
            <ul>
                <li>Ce rappel est automatique et prioritaire</li>
                <li>Une copie a Ã©tÃ© envoyÃ©e Ã  votre responsable</li>
                <li>Le non-paiement peut entraÃ®ner des sanctions</li>
                <li>En cas de difficultÃ©s, contactez-nous immÃ©diatement</li>
            </ul>
            
            <% if (reimbursement && reimbursement.escalationContacts && reimbursement.escalationContacts.length > 0) { %>
            <h3>ğŸ“ Contacts d'urgence</h3>
            <% reimbursement.escalationContacts.forEach(function(contact) { %>
            <p><strong><%= contact.role %> :</strong> <%= contact.name %> - <%= contact.email %> - <%= contact.phone || 'N/A' %></p>
            <% }); %>
            <% } %>
            
            <p><strong>Si vous avez dÃ©jÃ  effectuÃ© ce paiement, merci de nous transmettre immÃ©diatement le justificatif.</strong></p>
            
            <p>Cordialement,<br>
            <strong>L'Ã©quipe Finance - Service Recouvrement</strong></p>
        </div>
        
        <div class="footer">
            <p><strong>RAPPEL URGENT - PAIEMENT EN RETARD</strong></p>
            <p>Â© <%= new Date().getFullYear() %> - SystÃ¨me de rappels automatique</p>
            <p>Ce message a Ã©tÃ© envoyÃ© automatiquement. RÃ©ponse requise dans les 24h.</p>
        </div>
    </div>
</body>
</html>